var gameLogic;!function(a){"use strict";function b(){return[[4,4,4,4,4,4],[4,4,4,4,4,4]]}function c(a,b,c){return a[b][c]>(0===b?c:5-c)}function d(a,b){for(var d=0;6>d;d++)if(c(a,b,d))return!0;return!1}function e(a,b){for(var c=0,d=0;6>d;d++)c+=a[b][d];return c}function f(a,b){return 0!==e(a,1)||d(a,0)?0!==e(a,0)||d(a,1)?b[0]>24?0:b[1]>24?1:-1:(b[1]+=e(a,1),1):(b[0]+=e(a,0),0)}function g(a){return 24===a[0]&&24===a[1]?!0:!1}function h(a){var b=a.move,c=a.turnIndexBeforeMove,d=a.stateBeforeMove;try{var e=b[2].set.value,f=e.row,g=e.col,h=d.board,i=d.scores,k=j(h,f,g,c,i);if(!angular.equals(b,k))return!1}catch(l){return console.log(l),!1}return!0}function i(a,b,c){for(var d=[],e=0;6>e;e++)try{0!==a[b][e]&&d.push(j(a,b,e,b,c))}catch(f){}return d}function j(a,d,h,i,j){if(void 0===a&&(a=b(),j=[0,0]),i!==d)throw new Error("One can only sow seeds from his own houses!");if(0===a[d][h])throw new Error("One cannot sow seeds from empty house!");if(-1!==f(a,j)||g(j))throw new Error("Can only make a move if the game is not over!");if(!c(a,d,h)&&0===e(a,1-d))throw new Error("Cannot prevent the opponent from continuing the game!");var k=angular.copy(a),l=angular.copy(j),m=k[d][h],n=d,o=h,p=0===n?-1:1;for(k[n][o]=0;m>0;)o+=p,-1===o?(n=1,o=0,p*=-1):6===o&&(n=0,o=5,p*=-1),(n!==d||o!==h)&&(k[n][o]++,m--);p*=-1;var q=0,r=angular.copy(k),s=l[i];if(n===1-i)for(;o>=0&&5>=o&&(2===k[n][o]||3===k[n][o]);)l[i]+=k[n][o],k[n][o]=0,q++,o+=p;6===q&&(k=r,l[i]=s);var t,u=f(k,l);return t=-1!==u||g(l)?{endMatch:{endMatchScores:0===u?[1,0]:1===u?[0,1]:[0,0]}}:{setTurn:{turnIndex:1-i}},[t,{set:{key:"board",value:k}},{set:{key:"delta",value:{row:d,col:h}}},{set:{key:"scores",value:l}}]}a.getInitialBoard=b,a.canSowOpponent=c,a.hasHousesThatCanSowOpponent=d,a.getSeedsInRow=e,a.getWinner=f,a.isTie=g,a.isMoveOk=h,a.getPossibleMoves=i,a.createMove=j}(gameLogic||(gameLogic={}));var game;!function(a){"use strict";function b(){console.log("Translation of 'RULES_OF_OWARE' is "+translate("RULES_OF_OWARE")),resizeGameAreaService.setWidthToHeight(1.6),gameService.setGame({minNumberOfPlayers:2,maxNumberOfPlayers:2,isMoveOk:gameLogic.isMoveOk,updateUI:n}),dragAndDropService.addDragListener("gameArea",c)}function c(a,b,c){if(z=document.getElementById("gameArea"),A=[angular.element(document.getElementById("e2e_test_player1score")).parent(),angular.element(document.getElementById("e2e_test_player2score")).parent()],!J&&s){var f=e(),g=Math.min(Math.max(b-z.offsetLeft,0),z.clientWidth-f.width),i=Math.min(Math.max(c-z.offsetTop,0),z.clientHeight-f.height),j=Math.floor(B*i/z.clientHeight),l=Math.floor(C*g/z.clientWidth);if("touchstart"===a&&!y){D={row:j,col:l},E=angular.element(document.getElementById("e2e_test_seeds_"+D.row+"x"+D.col)),F=E.parent(),F.addClass("selected"),H=+E.text(),N=angular.copy(t),N[j][l]=0;var n=E[0].getBoundingClientRect();G={left:n.left-z.offsetLeft,top:n.top-z.offsetTop},y=angular.element('<div class="seeds dragging">'+H+"</div>"),y.css({"z-index":++I,top:Math.round(G.top)+"px",left:Math.round(G.left)+.25*f.width+"px",width:.3*f.width+"px",height:.3*f.width+"px","font-size":.2*f.width+"px",padding:.1*f.width+"px","line-height":.3*f.width+"px"}),angular.element(z).append(y)}if(y){if("touchend"===a){var p={row:j,col:l},q=p.col-D.col;0===D.row&&q>0||1===D.row&&0>q||(M=o(D.row,D.col),M&&(K=m(D.row,D.col,t,M[1].set.value),L=0,J=!0,k()))}else d(j,l);("touchend"===a||"touchcancel"===a||"touchleave"===a)&&(J||h(H))}}}function d(a,b){var c=f(a,b),d=e();y.css({left:c.left+(0===a?0:d.width/2)+"px",top:c.top+"px"})}function e(){return{width:z.clientWidth/C,height:z.clientHeight/B}}function f(a,b){var c=e();return{top:0===a?.42*c.height:1.1*c.height,left:b*c.width}}function g(a,b){return 0===a?b--:b++,0>b?(a=1,b=0):b>5&&(a=0,b=5),{row:a,col:b}}function h(a){y[0].style.opacity=0,F.removeClass("selected"),setTimeout(function(){N[D.row][D.col]=a,y.detach(),y=null,D=null},100)}function i(a,b){if(L<K.updates.length){var c=K.updates[L++];d(c.row,c.col),y.text(--a);var e=angular.element(document.getElementById("pit_"+c.row+"x"+c.col)).addClass("pos");setTimeout(function(){e.removeClass("pos")},2500);var f=angular.element(document.getElementById("e2e_test_seeds_"+c.row+"x"+c.col));N[c.row][c.col]=+f.text()+1,("2"===N[c.row][c.col]||"3"===N[c.row][c.col])&&e.addClass("captured"),i(a,b)}else L=0,setTimeout(function(){j(b)},400)}function j(a){if(L<K.captures.length){A[u].addClass("capture"),y.addClass("capture");var b=K.captures[L++];d(b.row,b.col);var c=angular.element(document.getElementById("e2e_test_seeds_"+b.row+"x"+b.col));y.text(+y.text()+ +c.text()),N[b.row][b.col]=0,setTimeout(function(){j(a)},400)}else L=0,setTimeout(a,100)}function k(){i(H,function(){h(0),gameService.makeMove(M),A[u].removeClass("capture"),M=null,J=!1})}function l(){var a=gameLogic.getPossibleMoves(t,u,v);gameService.makeMove(a[Math.floor(Math.random()*a.length)])}function m(a,b,c,d){for(var e,f=[],h=[],i={row:a,col:b},j=c[a][b];j;)i=g(i.row,i.col),(i.row!==a||i.col!==b)&&(e=d[i.row][i.col]-c[i.row][i.col],e>0?f.push({row:i.row,col:i.col}):0>e&&(f.push({row:i.row,col:i.col}),h.push({row:i.row,col:i.col})),j--);return h.reverse(),{updates:f,captures:h}}function n(a){t=a.stateAfterMove.board,w=a.stateAfterMove.delta,v=a.stateAfterMove.scores,void 0===t&&(t=gameLogic.getInitialBoard(),v=[0,0]),x=gameLogic.getPossibleMoves(t,a.turnIndexAfterMove,v),s=a.turnIndexAfterMove>=0&&a.yourPlayerIndex===a.turnIndexAfterMove,u=a.turnIndexAfterMove,s&&""===a.playersInfo[a.yourPlayerIndex].playerId&&(s=!1,$timeout(l,500))}function o(a,b){if(log.info(["Clicked on cell:",a,b]),"?throwException"===window.location.search)throw new Error("Throwing the error because URL has '?throwException'");if(!s)return!1;try{var c=gameLogic.createMove(t,a,b,u,v);return s=!1,c}catch(d){return log.info(["Cell is already full in position:",a,b]),!1}}function p(a,b){for(var c=0;c<x.length;c++){var d=x[c][2].set.value;if(a===d.row&&b===d.col)return!0}return!1}function q(a,b){return J?N[a][b]:t[a][b]}function r(a){return v[a]}var s,t,u,v,w,x,y,z,A,B=2,C=6,D=null,E=null,F=null,G=null,H=null,I=15,J=!1,K=null,L=0,M=null,N=null;a.init=b,v=[0,0],a.isValid=p,a.getSeeds=q,a.getScore=r}(game||(game={})),angular.module("myApp",["ngTouch","ui.bootstrap","gameServices"]).run(function(){$rootScope.game=game,translate.setLanguage("en",{RULES_OF_OWARE:"Rules of OWARE",RULES_SLIDE1:"To sow you must take all the seeds of  any of your holes and lay its out along the holes against the direction of the clockwise. In every hole you should lay it out one seed.  If you reach the last hole of your ground you must continue in the land of the other player. Remember, you always have to lay out seeds in the direction against the clockwise.",RULES_SLIDE2:"If the last hole where you sow is in the land of the other player and there are two or three seeds in the last hole remove from the board and keep them. If the previous holes also contain two or three seeds also remove them and remove all the seeds of your opponent that contains two or three seeds.",RULES_SLIDE3:"As the game progresses, it is possible that one hole contains more than 12 seeds. This hole is called Kroo and makes possible complete one round. When the harvest starts at the Kroo, this hole must finish empty what means that the player shouldnâ€™t lay out any seed.",RULES_SLIDE4:"To play a run  and  leaves the other player with no seeds to continue playing is not allowed. If you do it you will lose the game.",RULES_SLIDE5:"If the other player has only one seed in his field you will have to remove it in order to harvest and continue playing. Players must provide in advance to avoid this situation. If this is impossible, because we only have one seed in our land. The game is finished. The winner is the one that harvest more.",RULES_SLIDE6:"Game ends with a player having more than 23 seeds in his house. When there are few seeds left on the counter, the game may be perpetuating and hardly any of the 2 players can capture any new seed. By mutual agreement player can agree the end of the game. In this case every player is the owner of the seeds in his side.  As always, who has garnered more wins the match.",CLOSE:"Close"}),game.init()});var aiService;!function(a){"use strict";function b(a,b,f,g){return alphaBetaService.alphaBetaDecision([null,{set:{key:"board",value:a}},null,{set:{key:"scores",value:b}}],f,d,c,"?debug"===window.location.search?e:null,g)}function c(a){if(a[0].endMatch){var b=a[0].endMatch.endMatchScores;return b[0]>b[1]?Number.POSITIVE_INFINITY:b[0]<b[1]?Number.NEGATIVE_INFINITY:0}return 0}function d(a,b){return gameLogic.getPossibleMoves(a[1].set.value,b,a[3].set.value)}function e(a){return"\n"+a[1].set.value.join("\n")+"\n"}a.createComputerMove=b}(aiService||(aiService={}));
//# sourceMappingURL=everything.min.js.map